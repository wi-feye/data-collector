# Data Collector

Service able to get data from *Zerynth cloud* through api call, format them and send to *wi-feye* database the formatted results.

## Files
    .
    ├── src
    │   ├── service
    │   │   ├── exporter.js     # provides functions to export formatted data through post api call
    │   │   ├── formatter.js    # provides function to format Zerynth data to the ones sended to wi-feye db
    │   │   └── importer.js     # provides functions to get data from Zerynth cloud
    │   ├── controller.js       # main application controller that provides high level functions
    │   └── index.js            # main js file
    ├── .env-test
    ├── Dockerfile
    ├── package.json
    └── README.md

## Prerequisite
- docker
- zerynth api auth key
- wi-feye api auth key

Before server running must be create a **.env** file with the same structure of *.env-test*. Missing files should be filled with:

- ZERINTH_API_KEY= api key generated by [Zerynth cloud](https://cloud.zerynth.com/)
- ZERINTH_WORKSPACE_ID= Zerynth workspace id which we want to use by default
- WIFEYE_BASEURL_STORAGE= wi-feye base url where is hosted the db
- WIFEYE_API_KEY= wi-feye auth api key to send data to db service


## Build docker image
```
docker build . -t wifeye/data-collector
```

## Build and run with node
In this case prerequisites are:
- node
- npm
At te beginning launch command to install all libraries
```
npm install
```
then there are some commands to retrieve diffferent information
```
npm start help
```
list the available commands
```
npm start workspace_list
```
list the available workspaces
```
npm start device_list
```
list the available devices for the default workspace
```
npm start
```
launch the service with cron-node that schedule the data collector with the pattern defined in *.env* file to the voice CRON_CONFIG.